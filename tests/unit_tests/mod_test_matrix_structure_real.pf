module mod_test_matrix_structure_real
  use mod_suite_utils
  use funit
  use mod_matrix_structure, only: matrix_t, new_matrix
  implicit none

  type(matrix_t) :: matrix

contains

  @before
  subroutine init_test()
    call reset_globals()
    matrix = new_matrix(nb_rows=5)
  end subroutine init_test


  @after
  subroutine tear_down()
    call matrix%delete_matrix()
  end subroutine tear_down















  @test
  subroutine test_add_complex_element_to_real_node()
    complex(dp) :: element
    call set_name("matrix datastructure: add complex element to real node")
    call matrix%add_element(row=2, column=3, element=1.0d0)
    call matrix%add_element(row=2, column=3, element=(1.5d0, 2.0d0))
    element = matrix%get_complex_element(2, 3)
    @assertEqual((2.5d0, 2.0d0), element, tolerance=TOL)
  end subroutine test_add_complex_element_to_real_node


  @test
  subroutine test_add_element_invalid_type()
    call set_name("matrix datastructure: add invalid type")
    call matrix%add_element(row=2, column=1, element=1)
    @assertExceptionRaised("adding unexpected element type")
  end subroutine test_add_element_invalid_type


  @test
  subroutine test_add_invalid_type_to_real_node()
    call set_name("matrix datastructure: add invalid type to real node")
    call matrix%add_element(row=2, column=5, element=2.0d0)
    call matrix%rows(2)%add_node(column=5, element=2)
    @assertExceptionRaised("unable to do node element (real) + given number")
  end subroutine test_add_invalid_type_to_real_node


  @test
  subroutine test_get_single_real_element()
    call set_name("matrix datastructure: get single real element")
    call matrix%add_element(row=1, column=2, element=(2.0d0))
    @assertEqual(2.0d0, matrix%get_real_element(1, 2), tolerance=TOL)
  end subroutine test_get_single_real_element


  @test
  subroutine test_get_real_element_not_present()
    call set_name("matrix datastructure: get real not present")
    @assertEqual(0.0d0, matrix%get_real_element(1, 2), tolerance=TOL)
  end subroutine test_get_real_element_not_present






end module mod_test_matrix_structure_real
